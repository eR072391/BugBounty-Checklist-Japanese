# Web アプリのBug Bounty Checklist

> このチェックリストは、Bug Bountyの優れた方法論を確立するのに役立ちます。

## 目次

* [ワイルドカード ドメインの偵察](#"Recon_on_wildcard_domain")  
* [単一ドメイン](#Single_domain)  
* [情報収集](#Information)  
* [構成管理](#Configuration)  
* [安全な送信](#Transmission)  
* [認証](#Authentication)  
* [セッション管理](#Session)  
* [認可](#Authorization)  
* [データ検証](#Validation)  
* [サービス拒否](#Denial)  
* [ビジネスの論理](#Business)  
* [暗号化](#Cryptography)  
* [危険な機能 - ファイルのアップロード](#File)  
* [危険な機能 - カード支払い](#Card)  
* [HTML 5](#HTML)  


## <a name="Recon_on_wildcard_domain">ワイルドカード ドメインの偵察</a>  

- [ ] amass を実行する  
- [ ] subfinder を実行する  
- [ ] assetfinder を実行する  
- [ ] dnsgen を実行する  
- [ ] massdns を実行する  
- [ ] httprobe を使用する  
- [ ] aquatone を実行する(アクティブホストのスクリーンショット)  


## <a name="Single_domain">単一ドメイン</a>  

### 走査

- [ ] Nmap scan   
- [ ] Burp crawler   
- [ ] ffuf (directory and file fuzzing)
- [ ] hakrawler/gau/paramspider  
- [ ] Linkfinder  
- [ ] AndroidアプリのURL   

### 手動チェック    

- [ ] Shodan  
- [ ] Censys  
- [ ] Google dorks  
- [ ] Pastebin  
- [ ] Github  
- [ ] OSINT     

### <a name="Information">情報収集</a>
- [ ] サイトを手動で探索する。    
- [ ] スパイダー/クロールで見逃したコンテンツまたは非表示のコンテンツを探します。  
- [ ] robots.txt、sitemap.xml、.DS_Storeなどのコンテンツを公開するファイルを確認します。  
- [ ] 主要な検索エンジンのキャッシュを確認して、一般にアクセスできるサイトを確認する。  
- [ ] ユーザーエージェントに基づいてコンテンツの違いを確認します（モバイルサイト、検索エンジンクローラーとしてのアクセスなど）。  
- [ ] Webアプリケーションのフィンガープリントを実行する。  
- [ ] 使用されているテクノロジーを特定する。  
- [ ] ユーザーの役割を特定する。  
- [ ] アプリケーションのエントリポイントを特定する。  
- [ ] クライアント側のコードを特定する。  
- [ ] 複数のバージョン/チャネルを識別する（例：Web、モバイル Web、モバイル アプリ、Web サービス）。  
- [ ] 共同ホストされるアプリケーションと関連アプリケーションを特定する。  
- [ ] すべてのホスト名とポートを特定する。  
- [ ] サードパーティがホストするコンテンツを特定する。  
- [ ] デバッグパラメータの特定。  


### <a name="Configuration">構成管理</a>

- [ ] よく使用されるアプリケーションおよび管理 URL を確認する。  
- [ ] 古いファイル、バックアップファイル、参照されていないファイルを確認する。  
- [ ] サポートされている HTTP メソッドとクロスサイトトレース（XST）を確認します。  
- [ ] ファイル拡張子の処理をテストする。  
- [ ] セキュリティHTTPヘッダー（CSP、X-Frame-Options、HSTSなど）をテストします。  
- [ ] ポリシーのテスト（Flash、Silverlight、ロボットなど）。  
- [ ] 本番環境での非本番データのテスト、またはその逆のテスト。  
- [ ] クライアント側コード内の機密データ（APIキー、認証情報など）を確認します。  


### <a name="Transmission">安全な送信</a>

- [ ] SSLのバージョン、アルゴリズム、キーの長さを確認する。  
- [ ] デジタル証明書の有効性（有効期間、署名、CN）を確認する。  
- [ ] HTTPS 経由でのみ配信される資格情報を確認する。  
- [ ] ログイン フォームが HTTPS経由で配信されていることを確認する。  
- [ ] HTTPS 経由でのみ配信されるセッション トークンを確認する。  
- [ ] HTTP Strict Transport Security（HSTS）が使用されているかどうかを確認する。    



### <a name="Authentication">認証</a>
- [ ] ユーザー列挙のテスト。  
- [ ] 認証バイパスのテスト。  
- [ ] ブルートフォース保護のテスト。  
- [ ] パスワード品質ルールをテストする。  
- [ ] 「覚えておいてください」機能をテストする。  
- [ ] パスワードフォーム/入力時のオートコンプリートをテストする。  
- [ ] パスワードのリセットおよび/または回復をテストする。  
- [ ] パスワード変更プロセスのテスト。  
- [ ] CAPTCHAテスト。  
- [ ] 多要素認証をテストする。  
- [ ] ログアウト機能の有無をテストする。  
- [ ] HTTP でのキャッシュ管理のテスト（例： Pragma、Expires、Max-age）  
- [ ] デフォルトのログインをテストする。  
- [ ] ユーザーがアクセスできる認証履歴をテストする。  
- [ ] アカウントのロックアウトとパスワード変更の成功に関するチャネル外通知をテストする。  
- [ ] 共有認証スキーマ/SSO を使用してアプリケーション間で一貫した認証をテストする。  



### <a name="Session">セッション管理</a>
- [ ] アプリケーション内でセッション管理がどのように処理されるかを確立します（例： Cookie内のトークン、URL 内のトークン）。  
- [ ] Cookie フラグのセッション トークンを確認します（httpOnly および安全）。  
- [ ] セッション Cookie のスコープ（パスとドメイン）を確認する。  
- [ ] セッション Cookie の有効期間（有効期限と最大有効期間）を確認する。  
- [ ] 最大存続期間後にセッションが終了することを確認する。  
- [ ] 相対タイムアウト後のセッション終了を確認する。  
- [ ] ログアウト後のセッション終了を確認する。  
- [ ] ユーザーが複数の同時セッションを行えるかどうかをテストする。  
- [ ] セッション Cookie のランダム性をテストする。  
- [ ] ログイン、ロール変更、ログアウト時に新しいセッショントークンが発行されることを確認する。  
- [ ] 共有セッション管理を使用してアプリケーション間で一貫したセッション管理をテストする。  
- [ ] セッションの謎をテストする。  
- [ ] CSRF とクリックジャッキングのテスト。  



### <a name="Authorization">認可</a>
- [ ] パストラバーサルのテスト。  
- [ ] 認可スキーマをバイパスするためのテスト。  
- [ ] 垂直的なアクセス制御の問題（別名特権エスカレーション）をテストする。  
- [ ] 水平方向のアクセス制御の問題をテストする（同じ特権レベルの2人のユーザー間）。  
- [ ] 権限の欠落をテストする。  


### <a name="Validation">データ検証</a>
- [ ] リフレクト XSS のテスト。  
- [ ] ストアド XSS のテスト。  
- [ ] DOM ベースのXSS のテスト。  
- [ ] クロスサイトフラッシュのテスト。  
- [ ] HTML インジェクションのテスト。  
- [ ] SQL インジェクションのテスト。  
- [ ] LDAP インジェクションのテスト。  
- [ ] ORM インジェクションのテスト。  
- [ ] XML インジェクションのテスト。  
- [ ] XXE インジェクションのテスト。  
- [ ] SSL インジェクションのテスト。  
- [ ] XPath インジェクションのテスト。  
- [ ] XQueryインジェクションのテスト。  
- [ ] IMAP/SMTP インジェクションのテスト。  
- [ ] コードインジェクションのテスト。  
- [ ] 式言語インジェクションのテスト。  
- [ ] コマンドインジェクションのテスト。  
- [ ] オーバーフローのテスト（スタック、ヒープ、整数）。  
- [ ] フォーマット文字列のテスト。  
- [ ] 潜在化された脆弱性をテストする。  
- [ ] HTTP 分割/密輸のテスト。  
- [ ] HTTP動詞の改ざんをテストする。  
- [ ] オープンリダイレクトのテスト。  
- [ ] ローカルファイルインクルードをテストする。  
- [ ] リモートファイルインクルードをテストする。  
- [ ] クライアント側とサーバー側の検証ルールを比較する。  
- [ ] NoSQL インジェクションをテスト。  
- [ ] HTTPパラメータの汚染をテストする。  
- [ ] 自動バインドのテスト。  
- [ ] 質量割り当てのテスト。  
- [ ] NULL/無効なセッション Cookie のテスト。  

### <a name="Denial">サービス拒否</a>
- [ ] 自動化対策のテスト。  
- [ ] アカウントのロックアウトをテストする。  
- [ ] HTTP プロトコルの DoS をテストする。  
- [ ] SQL ワイルドカード DoS のテスト。  


### <a name="Business">ビジネスの論理</a>
- [ ] 機能の誤用をテストする。  
- [ ] 否認防止の有無をテストする。  
- [ ] 信頼関係をテストする。  
- [ ] データの整合性をテストする。  
- [ ] 職務の分離をテストする。  


### <a name="Cryptography">暗号化</a>
- [ ] 暗号化すべきデータが暗号化されていないかを確認する。  
- [ ] コンテキストに応じて間違ったアルゴリズムの使用をチェックする。  
- [ ] 弱いアルゴリズムの使用をチェックする。  
- [ ]   salt が適切に使用されているかを確認する。  
- [ ] ランダム性関数をチェックする。  


### <a name="File">危険な機能 - ファイルのアップロード</a>
- [ ] 許容可能なファイルタイプがホワイトリストに登録されていることをテストする。  
- [ ] ファイルサイズ制限、アップロード頻度、合計ファイル数が定義され、適用されていることをテストする。  
- [ ] ファイルの内容が定義されたファイルタイプと一致するかどうかをテストする。  
- [ ] すべてのファイルのアップロードでウイルス対策スキャンが実施されていることをテストします。  
- [ ] 安全でないファイル名がサニタイズされていることをテストする。  
- [ ] アップロードされたファイルが Webルート内で直接アクセスできないことをテストする。  
- [ ] アップロードされたファイルが同じホスト名/ポートで提供されないことをおテストする。  
- [ ] ファイルおよびその他のメディアが認証および認可スキーマと統合されていることをテストする。  


### <a name="Card">危険な機能 - カード支払い</a>
- [ ] Web サーバとWeb アプリケーションの既知の脆弱性と構成の問題をテストします。  
- [ ] デフォルトのパスワードまたは推測可能なパスワードをテストする。  
- [ ] 本番環境での非本番データのテスト、またはその逆のテスト。  
- [ ] インジェクションの脆弱性をテストする。  
- [ ] バッファオーバーフローのテスト。  
- [ ] 安全でない暗号化ストレージのテスト。  
- [ ] トランスポート層保護が不十分かどうかのテスト。  
- [ ] 不適切なエラー処理のテスト。  
- [ ] CVSS v2 スコアが 4.0 を超えるすべての脆弱性のテストをします。  
- [ ] 認証と認可の問題をテストする。  
- [ ] CSRF のテスト。  


### <a name="HTML">HTML 5</a>
- [ ] Web メッセージングのテスト。  
- [ ] Web ストレージ SQL インジェクションのテスト。  
- [ ] CORS実装を確認する。  
- [ ] オフライン Web アプリケーションを確認する。  

Source:  
[OWASP](https://www.owasp.org/index.php/Web_Application_Security_Testing_Cheat_Sheet)
